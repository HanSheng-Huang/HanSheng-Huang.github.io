<html>

<head>
    <meta charset="uft-8" />
    <link rel="manifest" href="manifest.json">
</head>

<body>
    <h1>It works!</h1>

    <main id="welcome-back" class="isPaused">
        <h1>Welcome back!</h1>
    </main>
</body>

<script>
    // 註冊  serviceWorker 並且需有 fetch 事件
    if ('serviceWorker' in navigator) {
        console.log("Will service worker register?");
        navigator.serviceWorker.register('service-worker.js?version=1').then(function (reg) {
            console.log("Yes it did.");
        }).catch(function (err) {
            console.log("No it didn't. This happened: ", err)
        });

    }
    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e) => {
        // 預防一開始 Google 跳出提醒視窗
        // e.preventDefault();
        // 把跳出視窗儲存
        deferredPrompt = e;
    });
    // 偵測是否安裝
    window.addEventListener('appinstalled', (evt) => {
        console.log('a2hs installed');
    });

    function myFunction() {
        // Show the prompt 跳出提醒視窗
        deferredPrompt.prompt();
        // Wait for the user to respond to the prompt
        // 了解使用者的選擇
        deferredPrompt.userChoice
            .then((choiceResult) => {
                if (choiceResult.outcome === 'accepted') {
                    console.log('User accepted the A2HS prompt');
                } else {
                    console.log('User dismissed the A2HS prompt');
                }
                deferredPrompt = null;
            });
    }
</script>

</html>